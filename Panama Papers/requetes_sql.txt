Combien la base de donn√©es contient-elle de soci√©t√©s offshores diff√©rentes dont la source est "Panama Papers" ?
  SELECT COUNT(DISTINCT name) 
  FROM entity
  WHERE source = 'Panama Papers'

  #r√©sultat 206 526 soci√©t√©s offshores


Quel interm√©diaire a cr√©√© le plus de soci√©t√©s offshores ? A-t-on son adresse et son pays ?
assoc_inter_enti >> inter et entity

  SELECT b.name, a.address, a.countries 
  FROM address a, intermediary b
  WHERE a.id_address =  b.id_address
  AND b.name 
  LIKE ( 
      SELECT b.name 
      FROM intermediary b, entity c, assoc_inter_entity d
      WHERE b.id = d.inter 
      AND c.id = d.entity
      GROUP BY b.name
      ORDER BY COUNT(b.name) DESC 
      LIMIT 1
  )

# √† partir du LIKE c'est l√† qu'on int√®gre la recherche de l'interm√©diaire avec le plus de soci√©t√©s = une REQU√äTE IMBRIQU√âE
# order pour organiser et desc de mani√®re d√©croissante, limite 1 c'est n'affichait que le 1er r√©sultat
# r√©sultat ORION HOUSE SERVICES (HK) - Adress : LIMITED ROOM 1401; 14/F.; WORLD COMMERCE  CENTRE;[...] TSUI; KOWLOON - Ville : HONG KONG


Combien la base contient-elle de b√©n√©ficiaires (officer) avec un nom unique ? # 122 590 b√©n√©ficiaires uniques # 
Quel est le b√©n√©ficiaire dont le nom revient le plus souvent ? # THE BEARER #
  
  SELECT COUNT(DISTINCT(name)) 
  FROM officer

puis

  SELECT name
  FROM officer
  GROUP BY name
  ORDER BY COUNT(*) DESC
  LIMIT 1;  


Donner la liste des juridictions avec le nombre d'entreprises offshores enregistr√©es sur chaque territoire, tri√©e par ordre d√©croissant.

  SELECT jurisdiction_description AS juridiction_list, COUNT(name) AS total_offshore_companies
  FROM entity
  GROUP by jurisdiction_description
  ORDER BY COUNT(name) DESC


Regrouper les soci√©t√©s offshores par statut, et trier la liste par ordre d√©croissant.

  SELECT e.status, COUNT(e.name) AS total_offshore_companies
  FROM entity e, source s
  WHERE e.source = s.source                                
  aND s.source = 'Panama Papers'
  GROUP by e.status
  ORDER BY COUNT(e.name) DESC


Trouver la liste des b√©n√©ficiaires dont le nom contient "BNP" et ajouter, pour chaque b√©n√©ficiaire, le nom des soci√©t√©s offshores.

  SELECT o.name AS BNP_beneficiary_list, e.name AS offshore_compagny
  FROM officer o, entity e, assoc_officer_entity a
  WHERE o.id = a.officer
  AND e.id = a.entity
  AND o.name LIKE '%BNP%'
  ORDER BY o.name


Trouver la liste des soci√©t√©s dont la juridiction est "France", "Monaco" ou "R√©union".

#Aucune juridiction n'est situ√©e dans ces pays, normal puisqu'il fallait qu'elle soit situ√©e dans des paradis fiscaux, mais on peut retrouver les fausses localisations en faisant : 

  SELECT e.name AS Company, a.country_codes AS pays, e.jurisdiction_description AS jurisdiction_name
  FROM entity e
  JOIN address a ON e.id_address = a.id_address
  WHERE a.country_codes = 'France' 
  OR a.country_codes = 'Monaco' 
  OR a.country_codes = 'R√©union'
  ORDER BY e.name


Trouver la liste des soci√©t√©s dont le pays de l'adresse et le pays de la juridiction sont diff√©rents.

  SELECT e.name AS Company, a.country_codes AS pays, e.jurisdiction_description AS jurisdiction_name
  FROM entity e
  JOIN address a ON e.id_address = a.id_address
  WHERE a.country_codes != e.jurisdiction_description
  AND e.name IS NOT NULL
  ORDER BY e.name

#Soit 200 179 soci√©t√©s offshores (distinct entities)



Trouver la liste des b√©n√©ficiaires qui ont des soci√©t√©s au m√™me nom et enregistr√©e √† la m√™me date, trier la liste par odre d√©croissant.

Donner la liste des interm√©diaires qui ont aussi √©t√© b√©n√©ficiaires, en ajoutant leur nom de b√©n√©ficiaire et leur adresse.

Donner le top 10 des b√©n√©ficiaires qui ont le plus d'identit√©s diff√©rentes (similar name and address) et le nombre d'identit√©s correspondant.

Donner le top 10 des b√©n√©ficiaires qui ont le plus de parts toujours valides dans des entreprises offshores (dont la date de fin n'est pas encore pass√©e).

Question bonus : r√©ussir √† retrouver dans la base au moins 3 personnalit√©s que tu connais (indice) üòéüòéüòé